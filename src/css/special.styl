// Если спецпроект интегрирован в сайт, из media queries обычно хватает только двух: mobile и not_mobile
@import './inc/mq'

@import './inc/functions'
@import './inc/keyframes'

@import './svg'

// base.styl подключается только в том случае, когда спецпроект расположен на отдельной странице
// @import 'base'

$colors = {
  white: #ffffff,
  black: #000000
}

// FYI: на десктопе на странице статьи максимальная ширина контейнера — 1060px. В ленте сайта — 640px.
// Мобильная версия начинается с 679px, и там ограничений по ширине нет

// Название класса рекомендуется выбирать так, чтобы точно не было конфликтов с существующими спецпроектами.
// Обычно имени проекта достаточно
.mgfn-trgt
  position relative

  font-size 16px
  line-height 1.5em

  --mgfn__svg-vc_logo: $svg.vc_logo
  --mgfn__svg-megafon_logo: $svg.megafon_logo
  --mgfn__svg-mark_success: $svg.mark_success
  --mgfn__svg-mark_failure: $svg.mark_failure
  --mgfn__svg-arrow: $svg.arrow
  --mgfn__svg-refresh: $svg.refresh

  @keyframes mgfn__typing-blink
    0%
      opacity .7
    50%
      opacity .5
    100%
      opacity .7

  &[data-theme='green']
    --mgfn__header-bg-color #00B956
    --mgfn__header-text-color #fff
    --mgtn__chat-scroll-color #00B956
    --mgtn__chat-text-color #00B956

  &[data-theme='pink']
    --mgfn__header-bg-color #fbeaee
    --mgfn__header-text-color #000
    --mgtn__chat-scroll-color #807678
    --mgtn__chat-text-color #FB9DB3

  --mgfn__switch-theme-transilion all .5s ease-in-out
  --mgfn__standard-transilion all .3s ease-in-out

  @media $mq.notMobile
    font-size 18px

  &__screens
    width 1060px; height 700px

  &__screen
    position relative
    width 100%; height 100%

    &:not([data-show])
      display none

    &--quiz
      background-color #F3F3F3

  &__phone
    position absolute
    width 300px; height 550px
    left 0; right 0; bottom 105px
    margin 0 auto

    &::before
      content ''
      position absolute
      width 100%; height 100%

      background-image url(img/phone-borders.png)
      background-size contain
      background-position center top
      background-repeat no-repeat

    &--notch
      content ''
      position absolute
      width 130px; height 30px
      left 0; right 0

      margin 5px auto 0

      background-color #fff
      border-radius 20px

      z-index 1

      &::before, &::after
        position absolute
        content ''
        background-color #E3E3E3

      &::before
        left 0; right 0; bottom 10px
        width 40px; height 5px
        margin 0 auto
        border-radius 100px

      &::after
        right 30px; bottom 9px
        width 8px; height 8px
        border-radius 99px

    &--content
      position absolute
      width 100%; height 100%
      padding 15px

      display grid
      grid-template-columns 1fr
      grid-template-rows 60px calc(100% - 60px)

      z-index 0

  &__header
    background-color var(--mgfn__header-bg-color)
    border-radius 30px 30px 0 0

    position relative

    color var(--mgfn__header-text-color)

    transition var(--mgfn__switch-theme-transilion)

    cursor default
    user-select none

    & > *
      position absolute

    &--counter, &--operator
      line-height 1.3

    &--counter
      top 5px; left 30px
      font-size .7em

    &--operator
      top 6px; right 20px
      font-size .5em

    &--sender, &--typing
      right 0; left 0

      text-align center
      line-height 1

    &--sender
      bottom 13px

      font-size .85em

    &--typing
      bottom 2px

      opacity .7

      animation mgfn__typing-blink 1s ease-in-out infinite

      font-size .6em

      &::before
        content '···'

        vertical-align middle
        margin-right 5px

        font-weight 700

    &--avatar
      right 5px; bottom 7px

      width 25px; height 25px

      background-image url(img/anon.png)
      background-size cover

  &__chat
    height calc(100% - 130px)
    padding 0 10px

    position relative

    background-image url(img/chat-bg.png)
    background-size cover

    overflow-y scroll
    overflow-x hidden

    scroll-behavior smooth

    &::-webkit-scrollbar
      width 4px

      &-thumb
        background-color #ccc

        &:hover
          background-color #999

    @supports (-moz-appearance: none) {
      scrollbar-width thin
      scrollbar-color #ccc #fff
    }

    &--bottom
      height 10px

  &__answers
    position absolute
    width 900px; height 250px
    left 0; right 0; bottom 0

    display grid

    grid-template-columns 1fr
    grid-template-rows 40px 1fr

    margin 0 auto

    border-radius 30px 30px 0 0

    background-color #fff
    box-shadow: 0px -1px 34px rgba(#000, .1)

    &--header, &--main
      position relative

    &--phrase, &--theme-switcher
      position absolute
      padding 15px
      color #A6A6A6

    &--phrase
      left 10px
      cursor default

    &--theme-switcher
      right 10px

      & > *
        display inline-block
        vertical-align middle

      input
        width auto
        margin-left 5px

    &-list, &-result
      display none
      width 100%; height 100%

    &[data-show='answers']
      & ^[-1]-list
        display grid

    &-list
      grid-template-columns 25% 25% 25% 25%
      grid-template-rows 1fr

      &-item
        display flex
        align-items center
        justify-content center

    &-item
      &-btn
        background-color transparent
        border 0

        user-select none
        cursor pointer

        transition var(--mgfn__standard-transilion)

        outline none

        &[disabled]
          cursor not-allowed

          & ^[-1]--face
            &::after
              content ''

        &:not([disabled]):hover
          opacity .8

          @media $mq.notHover
            opacity 1

        & > *
          pointer-events none

        &--face
          position relative
          height 100px
          display block

          img
            height 100%

          &::after
            position absolute
            width 20px; height 20px
            bottom 0; right 0

            background-image var(--mgfn__svg-mark_failure)
            background-size cover
            background-repeat no-repeat

        &--name
          margin-top 10px

          font-weight 700
          font-size 1.1em

        &--company
          margin-top 3px

          color #A6A6A6

    &[data-show='result']
      & ^[-1]--phrase
        display none

      & ^[-1]-result
        display flex

    &-result
      position relative

      align-items center
      justify-content center
      flex-flow column

      a
        color var(--mgtn__chat-text-color)
        border-bottom: 1px solid

        &:hover
          color #cd192e

      &[data-right='yes']
        & ^[-1]--status
          color #3BBA6E

      &[data-right='no']
        & ^[-1]--status
          color #E7473B

      &--status
        font-size 1.4em
        font-weight 700

        &:empty
          display none

      &--text
        max-width 550px
        margin-top 10px
        padding 0 10px

        font-size .85em
        text-align center

      &--next-btn
        position absolute
        bottom 15px; right 15px

        background-color transparent
        border 0

        transition var(--mgfn__standard-transilion)

        cursor pointer
        user-select none

        outline none

        &:not([data-end])::after
          content ''

          display inline-block
          width 1em; height 1em
          margin-left 5px

          vertical-align middle

          font-size .8em

          background-image var(--mgfn__svg-arrow)
          background-size contain
          background-repeat no-repeat

        &:hover
          opacity .8

          @media $mq.notHover
            opacity 1

  &__sms
    position relative
    margin-top 15px

    &:first-child
      margin-top 10px

    user-select none

    &:last-child
      margin-bottom 5px

    &-text, &-face
      display flex
      width 100%

    &-text
      &--content
        position relative
        padding 10px

        font-size .8em
        line-height 1.3

        box-shadow: 0px 0px 12px rgba(0, 0, 0, .15);

        background-color #fff

        ^[-1][data-tail='left']
          & ^[-1]
            border-radius 10px 10px 10px 0
            margin-left 10px

            &::after
              content ''

              position absolute
              width 0; height 0
              left -10px; bottom 0

              border-bottom 10px solid #fff
              border-left 10px solid transparent

        ^[-1][data-tail='right']
          flex-flow: row-reverse

          & ^[-1]
            border-radius 10px 10px 0 10px

            &::after
              content ''

              position absolute
              width 0; height 0
              right -10px; bottom 0

              border-bottom 10px solid #fff
              border-right 10px solid transparent

    &-text-content, &--sender, &--text
      width -webkit-fit-content
      width    -moz-fit-content
      width         fit-content

      word-wrap break-word

    &--sender
      white-space nowrap
      color var(--mgtn__chat-text-color)
      transition var(--mgfn__switch-theme-transilion)

    &--text
      margin-top 5px

    &-face
      width: 100%; height 150px

      position relative

      flex-flow row-reverse

      img
        height 100%

      &::before
        content ''
        position absolute
        top 0; left 0
        width 100%; height 100%

      &[data-success]::after, &[data-failure]::after
        content ''

      &::after
        position absolute
        width 30px; height 30px
        bottom 0; right 0

        background-size cover
        background-repeat no-repeat

      &[data-success]::after
        background-image var(--mgfn__svg-mark_success)

      &[data-failure]::after
        background-image var(--mgfn__svg-mark_failure)

  &__cache
    position absolute
    overflow hidden
    clip rect(0 0 0 0)

  .likely
    display flex

    &__widget
      display flex
      align-items center
      justify-content center
      background-color transparent
      border 1px solid
      height 40px
      padding 0 10px
      margin 0 2px
      color inherit

    &__icon
      background-color transparent

      svg
        display block

  // for Retina displays
  @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)
    ^[0]__phone
      &::before
        background-image url(img/phone-borders@2x.png)

    ^[0]__header
      &--avatar
        background-image url(img/anon@2x.png)

    ^[0]__chat
      background-image url(img/chat-bg@2x.png)
